---
phase: 02-content-engagement
plan: 03
type: execute
wave: 3
depends_on:
  - 02-02
files_modified:
  - components/GallerySection.vue
  - components/GalleryLightbox.vue
  - pages/index.vue
  - nuxt.config.ts
  - package.json
autonomous: true
requirements:
  - CONT-04
  - FND-04
  - VIS-04

must_haves:
  truths:
    - "Photo gallery displays campaign photos in grid layout"
    - "Clicking/tapping a photo opens lightbox modal for full-size viewing"
    - "Lightbox can be closed with Escape key or clicking outside image"
    - "All images include descriptive alt text for accessibility"
    - "Gallery is responsive (2 col mobile, 3 col tablet, 4 col desktop)"
    - "Images are optimized with WebP/AVIF format conversion"
  artifacts:
    - path: "components/GallerySection.vue"
      provides: "Photo gallery with grid layout and lightbox trigger"
      min_lines: 80
    - path: "components/GalleryLightbox.vue"
      provides: "Client-only lightbox modal component"
      min_lines: 60
  key_links:
    - from: "components/GallerySection.vue"
      to: "components/GalleryLightbox.vue"
      via: "client-only component import and event handling"
      pattern: "GalleryLightbox.*visible.*onClose"
    - from: "nuxt.config.ts"
      to: "@nuxt/image module"
      via: "module configuration"
      pattern: "image.*formats.*presets"
---

<objective>
Create the photo gallery section with lightbox modal — displaying campaign photos with accessibility and image optimization.

Purpose: The gallery showcases campaign activity, candidate engagement, and community involvement. A lightbox provides full-size viewing while maintaining page context. All images must be accessible with alt text per VIS-04.

Output: GallerySection.vue with photo grid, GalleryLightbox.vue (client-only) for modal viewing, @nuxt/image module configuration for optimization.
</objective>

<execution_context>
@/home/deck/.claude/get-shit-done/workflows/execute-plan.md
@/home/deck/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-content-engagement/02-RESEARCH.md
@.planning/phases/02-content-engagement/02-02-PLAN.md
@components/Navigation.vue
@nuxt.config.ts
@package.json

# Design Reference
Follow https://diijondacosta.com/ gallery pattern:
- Category tabs (School visits, Athletics, Graduations, etc.) — optional for Phase 2, can add tabs in Phase 3
- Grid layout: 2 col mobile, 3 col tablet, 4 col desktop
- Square aspect ratio thumbnails (aspect-square)
- Lightbox modal for full-size viewing
- Keyboard navigation (Escape to close)

# Phase 1 Patterns
- Use Composition API with <script setup lang="ts">
- Client-side plugins for browser-only features (.client suffix)
- Semantic HTML (section, figure, figcaption, button)
- Tailwind utility classes for styling

# Research Notes from 02-RESEARCH.md
- Lightbox SSR compatibility: Use native <dialog> element or .client plugin
- Image alt text is CRITICAL — all photos need descriptions
- @nuxt/image configuration: WebP/AVIF formats, lazy loading, responsive sizes
- LCP optimization: Hero image uses loading="eager", gallery uses loading="lazy"
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install @nuxt/image module and configure image presets</name>
  <files>package.json, nuxt.config.ts</files>
  <action>
Install and configure @nuxt/image module:

1. Install the module:
   ```bash
   npm install @nuxt/image
   ```

2. Add to nuxt.config.ts modules array:
   ```typescript
   modules: ['@nuxt/ui', '@nuxtjs/seo', '@nuxt/image'],
   ```

3. Configure image optimization:
   ```typescript
   image: {
     // Image quality
     quality: 80,
     // Modern formats (browser will use best supported)
     formats: ['webp', 'avif', 'jpeg'],
     // Screen sizes for responsive images
     screens: {
       xs: 320,
       sm: 640,
       md: 768,
       lg: 1024,
       xl: 1280
     },
     // Presets for gallery
     presets: {
       galleryThumb: {
         width: 400,
         height: 400,
         fit: 'cover',
         quality: 75,
         format: 'webp'
       },
       galleryFull: {
         width: 1200,
         quality: 85,
         format: 'webp'
       }
     }
   }
   ```

4. Verify installation works:
   ```bash
   npm run dev
   ```
   Should start without @nuxt/image errors.

Note: @nuxt/image may already be installed from @nuxt/ui dependency. Verify and add if missing.
  </action>
  <verify>
    @nuxt/image is in package.json dependencies, nuxt.config.ts includes @nuxt/image in modules array and has image configuration object with formats and presets.
  </verify>
  <done>
    @nuxt/image module installed and configured with WebP/AVIF format support, responsive screen sizes, and gallery presets (thumbnail and full-size).
  </done>
</task>

<task type="auto">
  <name>Task 2: Create GalleryLightbox client-only component</name>
  <files>components/GalleryLightbox.vue</files>
  <action>
Create components/GalleryLightbox.vue as a client-side only component:

1. File naming: components/GalleryLightbox.client.vue (the .client suffix ensures SSR-safe rendering)

2. Props interface:
   - visible: boolean (required)
   - images: Array of { src: string, alt: string } (required)
   - currentIndex: number (required)

3. Emits:
   - close: when user closes lightbox

4. Component structure:
   - Teleport to body (to avoid z-index issues)
   - Native <dialog> element with backdrop styling
   - Image container with max-w-[90vw] max-h-[90vh]
   - Close button (top-right)
   - Optional: Previous/Next navigation arrows

5. Keyboard handling:
   - Escape key closes lightbox
   - Arrow keys navigate between images (if implemented)

6. Focus trap:
   - When dialog opens, focus moves to close button
   - Tab key cycles within dialog

7. Body scroll lock:
   - Set document.body.style.overflow = 'hidden' when open
   - Reset to '' when closed

8. Implementation template:
   ```vue
   <template>
     <Teleport to="body">
       <dialog
         v-if="visible"
         ref="dialog"
         @click="handleBackdropClick"
         class="backdrop:bg-black/80 bg-transparent p-0 fixed inset-0 z-50"
       >
         <div
           v-if="currentImage"
           class="relative flex items-center justify-center min-h-screen"
           @click.stop
         >
           <!-- Image -->
           <img
             :src="currentImage.src"
             :alt="currentImage.alt"
             class="max-w-[90vw] max-h-[90vh] object-contain"
           />

           <!-- Close button -->
           <button
             @click="close"
             class="absolute top-4 right-4 text-white text-4xl hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-white"
             aria-label="Close lightbox"
           >
             &times;
           </button>
         </div>
       </dialog>
     </Teleport>
   </template>
   ```

9. Accessibility:
   - dialog element has native ARIA support
   - Close button has aria-label
   - Image has descriptive alt text
   - Escape key closes dialog (native behavior)
  </action>
  <verify>
    Component exists at components/GalleryLightbox.client.vue with Teleport, dialog element, close handler, and proper props interface.
  </verify>
  <done>
    GalleryLightbox component renders modal with image, close button, and backdrop. Handles Escape key and click-outside-to-close. Body scroll locks when open.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create GallerySection component with photo grid</name>
  <files>components/GallerySection.vue</files>
  <action>
Create components/GallerySection.vue:

1. Section structure:
   - section id="gallery" with py-20 bg-white
   - Container mx-auto px-4
   - Section heading: h2 text-3xl md:text-4xl font-bold text-center mb-12

2. Photo data (placeholder, to be replaced with actual photos):
   ```typescript
   interface Photo {
     id: string
     thumb: string
     full: string
     alt: string
   }

   const photos: Photo[] = [
     {
       id: '1',
       thumb: '/images/gallery/rally-1.jpg',
       full: '/images/gallery/rally-1-full.jpg',
       alt: 'Xzandria speaking at campaign rally in Warner Robins'
     },
     {
       id: '2',
       thumb: '/images/gallery/volunteers-1.jpg',
       full: '/images/gallery/volunteers-1-full.jpg',
       alt: 'Campaign volunteers distributing door hangers in Houston County'
     },
     // ... 8-12 photos total
   ]
   ```

3. Reactive state:
   - lightboxVisible: ref(false)
   - currentPhotoIndex: ref(0)

4. Grid layout:
   - div with grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4
   - Each photo wrapped in button (clickable, accessible)
   - Buttons have @click handler to open lightbox
   - Buttons have aria-label with photo description

5. Photo rendering:
   - Use NuxtImg for optimization
   - preset="galleryThumb" for thumbnails
   - loading="lazy" (all gallery images are non-critical)
   - aspect-square (1:1 ratio) with object-cover
   - rounded-lg for visual polish
   - hover:scale-105 transition-transform for interaction feedback

6. Lightbox integration:
   - GalleryLightbox component after grid
   - Pass visible, images, currentIndex props
   - @close event handler sets lightboxVisible to false

7. Accessibility:
   - Photo buttons have aria-label using photo.alt
   - Images have alt text
   - Lightbox is keyboard accessible

8. Empty state:
   - If no photos available, show placeholder message:
     "Gallery coming soon! Check back for campaign photos."
  </action>
  <verify>
    Component exists at components/GallerySection.vue with id="gallery", photos array, grid layout with NuxtImg components, GalleryLightbox integration, and click handlers.
  </verify>
  <done>
    GallerySection displays photo grid (2x3x4 responsive). Clicking photo opens lightbox modal. All images have alt text. Lightbox closes with Escape or click outside.
  </done>
</task>

<task type="auto">
  <name>Task 4: Create placeholder images directory and README</name>
  <files>public/images/gallery/.gitkeep, public/images/gallery/README.md</files>
  <action>
Create placeholder structure for gallery images:

1. Create directory: public/images/gallery/
2. Add .gitkeep file (empty) to preserve directory in git
3. Add README.md with instructions:
   ```markdown
   # Campaign Photo Gallery

   Place campaign photos in this directory.

   ## Naming Convention
   - Thumbnails: {name}.jpg (400x400px recommended)
   - Full-size: {name}-full.jpg (1200px width recommended)

   ## Alt Text Requirements
   All photos MUST have descriptive alt text. See components/GallerySection.vue photos array.

   ## Photo Categories
   - Candidate portraits and events
   - Team/volunteer activities
   - Community engagement
   - Endorsements and supporters

   ## Format
   - JPG format preferred for photos
   - WebP conversion handled by @nuxt/image
   - Maintain aspect ratio or crop to square for thumbnails
   ```

Note: Actual photos will be provided by campaign. Gallery will show "coming soon" message until photos are added.
  </action>
  <verify>
    public/images/gallery/ directory exists with .gitkeep and README.md file.
  </verify>
  <done>
    Gallery image directory structure exists with documentation for adding photos. Gallery component handles missing photos gracefully.
  </done>
</task>

<task type="auto">
  <name>Task 5: Integrate GallerySection into index.vue</name>
  <files>pages/index.vue</files>
  <action>
Update pages/index.vue to include GallerySection:

1. Add gallery section after PlatformSection:
   ```vue
   <template>
     <!-- Hero -->
     <section id="hero">
       <HeroSection />
     </section>

     <!-- About -->
     <section id="about">
       <AboutSection />
     </section>

     <!-- Platform -->
     <section id="platform">
       <PlatformSection />
     </section>

     <!-- Gallery -->
     <section id="gallery">
       <GallerySection />
     </section>
   </template>
   ```

2. Verify Navigation component scrolls to gallery when "Gallery" link is clicked
3. Verify scroll spy highlights "Gallery" when scrolled into view
  </action>
  <verify>
    pages/index.vue contains gallery section element with id="gallery" and GallerySection component, positioned after Platform section.
  </verify>
  <done>
    Homepage displays Gallery section after Platform. Navigation smooth-scrolls to gallery. Scroll spy highlights "Gallery" when visible.
  </done>
</task>

</tasks>

<verification>
Overall verification steps:

1. Build verification: Run `npm run generate` — site builds without errors
2. Visual verification: Open .output/public/index.html in browser
3. Gallery section visible with photo grid (or "coming soon" if no photos)
4. Clicking a photo opens lightbox modal
5. Lightbox closes with Escape key
6. Lightbox closes when clicking outside image
7. Body scroll is locked when lightbox is open
8. Images have proper alt text (check browser dev tools)
9. Responsive check: 2 col mobile, 3 col tablet, 4 col desktop
10. Navigation "Gallery" link scrolls to section

Note: Placeholder photos won't display until actual images are added to public/images/gallery/. The component should handle this gracefully with "coming soon" message.
</verification>

<success_criteria>
1. Photo gallery displays campaign photos in responsive grid layout
2. Clicking/tapping a photo opens lightbox modal with full-size image
3. Lightbox closes with Escape key, close button, or clicking outside
4. All images have descriptive alt text for accessibility (VIS-04)
5. Images are optimized with WebP/AVIF format conversion (@nuxt/image)
</success_criteria>

<output>
After completion, create `.planning/phases/02-content-engagement/02-03-SUMMARY.md` documenting:
- Components created (GallerySection.vue, GalleryLightbox.client.vue)
- @nuxt/image module configuration
- Image optimization setup
- Accessibility features (alt text, keyboard navigation)
- Any deviations from plan
- Time to complete
</output>
